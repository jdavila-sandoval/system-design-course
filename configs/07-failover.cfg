global
    daemon
    stats socket /var/run/haproxy.sock mode 600 level admin

defaults
    mode http
    timeout connect 2s
    timeout client 30s
    timeout server 30s
    option httplog
    option httpchk GET /

frontend my_http_frontend
    bind *:8080
    default_backend my_backends

backend my_backends
    balance roundrobin
    option httpchk GET /
    server web1 127.0.0.1:8001 check inter 2s rise 2 fall 3
    server web2 127.0.0.1:8002 check inter 2s rise 2 fall 3
    server web3 127.0.0.1:8003 check inter 2s rise 2 fall 3
    server web4 127.0.0.1:8004 check inter 2s rise 2 fall 3 backup
    server web5 127.0.0.1:8005 check inter 2s rise 2 fall 3 backup

frontend stats
    bind *:8404
    stats enable
    stats uri /stats
    stats refresh 30s
    stats admin if TRUE
