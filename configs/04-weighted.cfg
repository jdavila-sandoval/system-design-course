global
    daemon
    stats socket /var/run/haproxy.sock mode 600 level admin

defaults
    mode http
    timeout connect 5s
    timeout client 50s
    timeout server 50s
    option httplog

frontend my_http_frontend
    bind *:8080
    default_backend my_backends

backend my_backends
    balance roundrobin
    server web1 127.0.0.1:8001 check weight 50  # 50% of traffic
    server web2 127.0.0.1:8002 check weight 30  # 30% of traffic
    server web3 127.0.0.1:8003 check weight 20  # 20% of traffic

frontend stats
    bind *:8404
    stats enable
    stats uri /stats
    stats refresh 30s
    stats admin if TRUE
